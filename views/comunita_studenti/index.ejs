<%- include('../header') -%>


<table id="header" border="0" width="100%"
		cellpadding="0" cellspacing="0" bgcolor="#b10b25" style="position:fixed; z-index: 1; top:0; left:0;">
		<tr>
			<td>
				<table border="0" cellpadding="15" cellspacing="0" width="100%" align="left">
					<tr>	
						<td>
              <img src="/images/sigillo_universita/ti_200x200.png" width="100" height="100"  alt="univents_logo">
							<font face="Helvetica Neue" size="6" position="center" color="white">
                	<b>Univents</b> <br>
                  <b>Comunita Studenti</b>
							</font>
						</td>	
            <td>
							<a href="/impostazioni" style="text-decoration:none; float:right;">
								<font face="Helvetica neue" size="5" color=white >
									Impostazioni
								</font>
							</a>
						</td>					
					</tr>
				</table>
			</td>
		</tr>
	</table>
<br><br><br>
<style>
.eventbox{
  height: 50px;
  width: 500px;
  background-color: #f0d6d6;
  border: 5px solid red;
  border-radius: 20px;
  padding: 20px;
  text-align: center;
  margin: 10px;
  z-index: -1;
  position:relative;
  box-shadow: -4px 5px 7px #666666;
}
.puppet{
  height: 0px;
  width: 500px;
  top: 150px;
  left: 40%; 
  position: relative;
}
.empty-star{
  float:right;
  margin-left: 9px;
  display: inline-block;
  color: #F0F0F0;
  text-shadow: 0 0 1px #666666;
  font-size: 30px;
}
.highlight,
.selected{
  color: #F4B30A;
  text-shadow: 0 0 1px #F48F0A;
}
.div{
  margin-top: 0px;
  margin-left: 0px;
  width: 100%;
  height: 50%;
  background-color: red;
  position:absolute;
}
.button{
  background-color: #B10B25;
  border:none;
  color: #FFFF;
  width: 140px;
  height: 40px;
  border-radius: 15px;
  box-shadow: -2px 2px 5px #666666;
}
</style>

<!-- <div class="div"></div> -->


<template>
  <ul>
    <li id="fav" class="empty-star" onclick="highlight(this)">★</li>
  </ul>
  <div class="eventbox" onclick="set_info_box(this);" name="" place="" date="" time="" info=""></div>    
</template>
 
<div class="puppet" id="puppet"></div>

<div id="comunita_studenti">
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      fetch('http://localhost:3000/api/v1/eventi',{
        method:"GET",
        cache:'no-cache',
        headers:{
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
      })
        .then((res) =>{
          return res.json()
        } )
        .then((data) => {
          var i,item,clone;
          for(i=0;i<data.length;i++){
            item = document.getElementsByTagName("template")[0].content;
            clone = document.importNode(item,true);
            var body=clone.querySelector("div");

            body.setAttribute('style', 'white-space: pre;');
            body.textContent=data[i].title+"\n";
            body.textContent+=data[i].date_event.slice(0,10)+" alle "+data[i].date_event.slice(11,16)+", "+data[i].place;

            body.setAttribute("name",data[i].title);
            body.setAttribute("place",data[i].place);
            body.setAttribute("date",data[i].date_event.slice(0,10));
            body.setAttribute("time",data[i].date_event.slice(11,16));
            body.setAttribute("info",data[i].info);

            
            document.getElementById("puppet").appendChild(clone);
          }

      })
      }, false);

      function set_info_box(evento){

        a=document.getElementById("info_nome");
        b=document.getElementById("info_dove");
        c=document.getElementById("info_quando");
        d=document.getElementById("info_info");

        a.textContent="NOME\n";
        a.textContent+=evento.getAttribute("name");

        b.textContent="DOVE\n";
        b.textContent+=evento.getAttribute("place");

        c.textContent="QUANDO\n";
        c.textContent+=evento.getAttribute("date")+" alle "+evento.getAttribute("time");

        d.textContent="INFO\n";
        d.textContent+=evento.getAttribute("info");
      }

      function goto_home(){
        location.assign('http://localhost:3000/home');
      }

      function goto_universita(){
        location.assign('http://localhost:3000/universita');
      }

      function highlight(value){
        value.classList.toggle("selected");
        //TODO:CONNECT TO DB AND SET FAVOURITE
      }

  </script>

  <form method="get" action="/comunita_studenti/crea_evento">
    <p>
      <input class="button" type="submit" value="crea evento" style=" position:fixed; top:30%; height: 40px;background-color: #B10B25;
      border:none;
      color: #FFFF;
      width: 140px;
      height: 40px;
      border-radius: 15px;
      box-shadow: -2px 2px 5px #666666;">
    </p>
  </form>

  <button class="button" style="position: fixed; top:30%; left:25%;">Filtra eventi</button>


  
    <p>
    <label id="puppet" x="75%" y="0"></label>
  </p>


    <table id="evento" border="0" width="30%" align="left"
<<<<<<< Updated upstream
    cellpadding="0" cellspacing="0" bgcolor="#cccccc" style="position:fixed; top:38%">
=======
      cellpadding="0" cellspacing="0" bgcolor="#cccccc" style="position:fixed; top:38%">
>>>>>>> Stashed changes
      <tr>
        <td>
          <table border="0" cellpadding="15"  
            <tr>
              <td width="60%">

                <font id="info_nome" face="Helvetica" size="4"
                color="black">
                NOME:
                </font>

                <hr color="#b10b25" style="margin-top: 2em; margin-bottom: 2em;">

                <font id="info_dove" face="Helvetica" size="4"
                color="black">
                DOVE:
                </font>

                <hr color="#b10b25" style="margin-top: 2em; margin-bottom: 2em;">

                <font id="info_quando" face="Helvetica" size="4"
                color="black">
                QUANDO:
                </font>

                <hr color="#b10b25" style="margin-top: 2em; margin-bottom: 2em;">

                <font id="info_info" face="Helvetica" size="4"
                color="black">
                INFO:
                </font>

              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>

  
  <ul style="bottom: 100px; right: 100px; position:fixed">
    <button onclick="goto_home()" style="width:12%; align-content: center; position:fixed; right: 100px; ">Home</button><br><br>
    <button onclick="goto_universita()" style="width:12%; align-content: center; position:fixed; right: 100px;">Università</button>
  </ul>
</div>

<%- include('../footer') -%>
